## 基本概念和基础命令
Vim 跳转到行首的命令是 0，跳转到行尾的命令是 $，我们也有 ^, 用来跳转到行首的第一个非空白字符。

Vim 支持使用 b/w 和 B/W，来进行以单词为单位的跳转。它们的意思分别是 words Backward 和 Words forward

现在光标在 if (frame->fr_child != NULL) 第五个字符上，如果我们想要修改括号里的所有内容，我们就需要使用 f（find）和 t（till）了。它们的作用都是找到下一个紧接着输入的字符, 两者的区别是，f 会包含这个字符，而 t 不会包含这个字符。如果需要反方向搜索的话，使用大写的 F 和 T 就可以。

对于写文字的情况，下面的光标移动键也会比较有用：
* `(` 和 `)` 移到上一句和下一句
* `{` 和 `}` 移到上一段和下一段

* `d` 加动作来进行删除（`dd` 删除整行）；`D` 则相当于 `d$`，删除到行尾。

* `c` 加动作来进行修改（`cc` 修改整行）；`C` 则相当于 `c$`，删除到行尾然后进入插入模式。

* `s` 相当于 `cl`，删除一个字符然后进入插入模式；`S` 相当于 `cc`，替换整行的内容。

* `i` 在当前字符前面进入插入模式；`I` 则相当于 `^i`，把光标移到行首非空白字符上然后进入插入模式。

* `a` 在当前字符后面进入插入模式；`A` 相当于 `$a`，把光标移到行尾然后进入插入模式。

* `o` 在当前行下方插入一个新行，然后在这行进入插入模式；`O` 在当前行上方插入一个新行，然后在这行进入插入模式。

* `r` 替换光标下的字符；`R` 则进入替换模式，每次按键（直到 `<Esc>`）替换一个字符。

* `u` 撤销最近的一个修改动作；`U` 撤销当前行上的所有修改。

### 文本对象选择

到现在，我们已经学习过，可以使用 `c`、`d` 加动作键对这个动作选定的文本块进行操作，也可以使用 `v` 加动作键来选定文本块（以便后续进行操作），我们也学习了好些移动光标的动作。不过，还有几个动作只能在 `c`、`d`、`v`、`y` 这样命令之后用，我们也需要学习一下。

这些选择动作的基本附加键是 `a` 和 `i`。其中，`a` 可以简单理解为英文单词 a，表示选定后续动作要求的完整内容，而 `i` 可理解为英文单词 inner，代表后续动作要求的内容的“内部”。这么说，还是有点抽象，我们来看一下具体的例子。

假设有下面的文本内容：

```bash
if (message == "sesame open")
```

我们进一步假设光标停在“sesame”的“a”上，那么（和一般的行文惯例不同，下面在命令外面也加上了引号，避免可能的歧义）：

* ‘`dw`’（理解为 delete word）会删除“`ame␣`”，结果是“`if (message == "sesopen")`”
* ‘`di(`’或‘`di)`’会删除“`message == "sesame open"`”，结果是“`if ()`”
* ‘`da(`’或‘`da)`’会删除“`(message == "sesame open")`”，结果是“`if␣`”

上面演示了 `a`、`i` 和 `w`、双引号、圆括号搭配使用，这些对于任何语言的代码编辑都是非常有用的。实际上，可以搭配的还有更多：

* 搭配 `s`（sentence）对句子进行操作——适合西文文本编辑
* 搭配 `p`（paragraph)对段落进行操作——适合西文文本编辑，及带空行的代码编辑
* 搭配 `t`（tag）对 HTML/XML 标签进行操作——适合 HTML、XML 等语言的代码编辑
* 搭配 `` ` `` 和 `'` 对这两种引号里的内容进行操作——适合使用这些引号的代码，如 shell 和 Python
* 搭配方括号（“\[”和“]”）对方括号里的内容进行操作——适合各种语言（大部分都会用到方括号吧）
* 搭配花括号（“{”和“}”）对花括号里的内容进行操作——适合类 C 的语言
* 搭配角括号（“<”和“>”）对角括号里的内容进行操作——适合 C++ 的模板代码

### 移动
Vim 里还能翻半页，有时也许这种方式更方便，需要的键是 `<C-U>` 和 `<C-D>`，Up 和 Down。  

你只关心当前屏幕的话，可以快速移动光标到屏幕的顶部、中间和底部：用 `H`（High）、`M`（Middle）和 `L`（Low）就可以做到。

只要光标还在屏幕上，你也可以滚动屏幕而不移动光标（不像某些其他编辑器，Vim 不允许光标在当前屏幕以外）。需要的按键是 `<C-E>` 和 `<C-Y>`。

### 重复，重复，再重复
我们已经看到，在 Vim 里有非常多的命令，而且很多命令都需要敲好几个键。如果你要重复这样的命令，每次都要再手敲一遍，这显然是件很费力的事。作为追求高效率的编辑器，这当然是不可接受的。除了我们以后要学到的命令录制、键映射、自定义脚本等复杂操作外，Vim 对很多简单操作已经定义了重复键：

* `;` 重复最近的字符查找（`f`、`t` 等）操作
* `,` 重复最近的字符查找操作，反方向
* `n` 重复最近的字符串查找操作（`/` 和 `?`）
* `N` 重复最近的字符串查找操作（`/` 和 `?`），反方向
* `.` 重复执行最近的修改操作

### 正则

* `.` 可以匹配除换行符外的任何字符：如 `a.` 可以匹配“aa”、“ab”、“ac”等，但不能匹配“a”、“b”或“ba”。如果需要匹配换行符（跨行匹配）的话，则需要使用 `_.`。

* `*` 表示之前的匹配原（最普通的情况为单个字符）重复零次或多次：如 `aa*` 可以匹配“a”、“aa”或“aaa”，`a.*` 可以匹配“a”、“aa”、“abc”等等，但两者均不能匹配“b”。

* `^` 匹配一行的开头，如果出现在模式的开头的话；在其他位置代表字符本身。

* `$` 匹配一行的结尾，如果出现在模式的结尾的话；在其他位置代表字符本身。

* `~` 匹配上一次替换的字符串，即如果上一次你把“foo”替换成了“bar”，那 `~` 就匹配“bar”。

* `[…]` 匹配方括号内的任一字符；方括号内如果第一个字符是 `^`，表示对结果取反；除开头之外的 `-` 表示范围：如 `[A-Za-z]` 表示任意一个拉丁字母，`[^-+*/]` 表示除了“+”、“-”、“\*”、“/”外的任意字符。

接下来，我再和你分享 13 个特殊模式项。虽然它们相对来说不那么必需，但掌握它们可以大大地提高程序员的编辑效率。

* `\<` 匹配单词的开头
* `\>` 匹配单词的结尾
* `\s` 匹配空白字符 `<Space>` 和 `<Tab>`
* `\S` 匹配非空白字符
* `\d` 匹配数字，相当于 `[0-9]`
* `\D` 匹配非数字，相当于 `[^0-9]`
* `\x` 匹配十六进制数字，相当于 `[0-9A-Fa-f]`
* `\X` 匹配非十六进制数字，相当于 `[^0-9A-Fa-f]`
* `\w` 匹配单词字符，相当于 `[0-9A-Za-z_]`
* `\W` 匹配非单词字符，相当于 `[^0-9A-Za-z_]`
* `\h` 匹配单词首字符，相当于 `[A-Za-z_]`
* `\H` 匹配非单词首字符，相当于 `[^A-Za-z_]`
* `\c` 忽略大小写进行匹配

### Vim 寄存器/剪贴板

我们已经学到，Vim 的删除和复制命令（如 `d` 和 `y`）会把内容存起来，以供粘贴命令（如 `p` 和 `P`）使用。我们还没有讨论这种内容存储有什么特别的地方。

首先，估计你已经知道的是，Vim 把要粘贴的内容存在 Vim 内部的“寄存器”（register）里，而非系统的剪贴板。你不一定知道的是，Vim 里的寄存器有好多个。事实上，Vim 有超过 40 个不同的寄存器！我们挨个来看一下：

* 首先是无名寄存器。当操作没有用 `"` 加寄存器名称指定寄存器时，我们默认使用无名寄存器。不过，我们仍可以使用 `""` 来指定使用无名寄存器，也就是说，`""p` 和 `p` 效果相同。
* 其次是数字寄存器 `0` 到 `9`。`0` 号寄存器中放的永远是最近一次复制（yank）的内容。这和无名寄存器很不一样，它里面放的是最近操作的结果，也包括了 `d`、`x`、`c` 等命令，特别是包括了粘贴命令所替换的内容。`1` 到 `9` 号寄存器中放的则是上一次、倒数第二次、直到倒数第九次被删除或修改命令删除的文本。在做少量的用一个名字替换另一个名字、而又懒得使用替换命令时，`"0p` 是一个接近图形界面里的粘贴命令的常用选择。
* 然后有小删除寄存器 `-`。上面我说得不全，删除内容进入 `1` 到 `9` 号寄存器的前提条件是被删除的内容至少有一行，或者使用了移动命令 `%`、`(`、`)`、`` ` ``、`/`、`?`、`n`、`N`、`{` 和 `}` 进行删除。否则，删除的内容只会进入 `-` 而不是 `1` 到 `9` 号寄存器。
* 常用的有名寄存器 `a` 到 `z`。这些寄存器仅在用户手工指定时才会使用，内容在下一次打开 Vim 时仍然存在。比如，我们可以用 `"ayy` 代替 `yy` 把当前行复制到 `a` 寄存器中，以后就一直可以用 `"ap` 来进行粘贴了，直到 `a` 寄存器的内容被替换为止。
* 不常用的特殊寄存器 `.` 、`:`、`#` 和 `%`。
* 黑洞寄存器 `_`。专门用来删除，目的就是不要影响无名寄存器的内容。
* 搜索寄存器 `/`。存放是上一次搜索使用的模式。
* 表达式寄存器 `=`。可以把 Vim 表达式估值的结果作为寄存器的内容。这个我们以后讲 Vim 脚本编程的时候再探讨。
* 最后是图形界面剪贴板寄存器 `+`、`*` 和 `~`。一般而言，`+` 寄存器代表操作系统的剪贴板，和图形界面应用程序交互用这个就好；你用图形界面 Vim 菜单里的拷贝和粘贴访问的也是系统剪贴板。`*` 和 `~` 在 X11 和 GTK 环境下有一些特殊用途，我们目前就不展开了。

寄存器在正常模式下可以用 `d`、`y`、`p` 等命令来访问，你现在应当已经很清楚了。它们在插入模式和命令行模式下也可以用 `C-R` 加寄存器名来访问，这经常也会省去你很多打字的麻烦。

这些寄存器当然不是每个都常用。具体你是否会用到它们，取决你的工作方式。下面我说几个我自己编辑时的常用场景。